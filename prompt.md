# 看護師シフト自動作成

## 🎯 目的
あなたは看護部長として、2025年8月分（7月21日〜8月20日、31日間）の看護師シフト表を作成します。14名の看護師を対象に、以下の制約に基づいて、Excelテンプレート形式で正確にシフトを割り当ててください。

## 👥 看護師一覧（14名）
- 久保
- 三好
- 御書
- 板川
- 友枝
- 樋渡
- 中山
- 川原田
- 奥平
- 前野
- 森園
- 小嶋
- 田浦
- 久保（千）

## 📅 期間
- シフト対象期間：**2025年7月21日〜2025年8月20日**

## 🚫 定休日
- 毎週木曜：1日休み
- 毎週日曜：1日休み
- 毎週土曜：午後休み

## 🧩 制約ルール

- 「板川」・「三好」：「夜勤」不可
- 「御書」：「夜勤」・「外来」・「残日」・「早日」不可
- 毎日1人は「夜勤」が必要
- 夜勤の次の日は必ず「×」
- 7連勤禁止
- 各看護師1日1シフト厳守
- 休暇希望は優先的に考慮
- 病院の休日(木曜・日曜1日休み)は「久保」、「小嶋」、「久保（千）」、「田浦」は必ず1日休み(それ以外の看護師は休日出勤有り)
- 休みは全員ほぼ均等に（法律上最低13日休みを確保する必要がある）
- 第2木曜日は「久保」に「/訪」(訪看日)を入れる
- 各勤務（夜勤、病棟、外来）は、なるべく看護師間で**均等にローテーション**するようにしてください。
- 「早」「残」「〇」「1〜4」「CT」などの担当も、できるだけ偏りなく**公平に**分担してください。
- 曜日毎にシフト作成の制約が異なる(下記「各曜日の必要人数制約」参照)

## 👥 各曜日の必要人数制約

### 🗓 月・火・水・金曜日

#### ✅ 出勤可能人数が「8人以上」の場合
- **外来担当**（計5人）
  - 「1」「2」「3」「4」「CT」をそれぞれ1人ずつ**均等に**担当
    - 「CT」担当は基本「久保」、久保が休みなら「三好」または「前野」が代行
    - 「1〜4」の外来は、なるべく「小嶋」「久保（千）」「田浦」が**均等に**担当
    - 「御書」「三好」以外の看護師は、「4番」外来になるべく月1回は入ること
- **病棟担当**（計3人）
  - 「早」「残」「〇」をそれぞれ1人ずつ**均等に**担当
  - 担当は、「久保」「小嶋」「久保（千）」「田浦」**以外の看護師**
- 残りの看護師は「休」

#### ✅ 出勤可能人数が「7人」の場合
- **外来担当**（計4人）
  - 「1」「2・CT」「3」「4」をそれぞれ1人ずつ**均等に**担当
    - 「2・CT」は「久保」が基本担当、休みの場合は「三好」または「前野」が代行
    - その他の外来は「小嶋」「久保（千）」「田浦」が優先
    - 「御書」「三好」以外の看護師は、「4番」外来になるべく月1回は入ること
- **病棟担当**（計3人）
  - 「早」「残」「〇」をそれぞれ1人ずつ**均等に**担当
  - 担当は、「久保」「小嶋」「久保（千）」「田浦」**以外の看護師**

---

### 🗓 木曜・日曜（定休日）

- **病棟担当のみ**（計2人）
  - 「早日」「残日」をそれぞれ1人ずつ**均等に**配置
  - 担当は「久保」「小嶋」「久保（千）」「田浦」**以外の看護師**
- 残りの看護師は「休」

---

### 🗓 土曜日（午後休）

- **外来担当**
  - 「久保」が基本的に「2/」を担当（午後の外来）
  - 久保が休みの場合：「小嶋」「久保（千）」「田浦」が交代で**均等に**担当
  - さらに、上記4名の中から不足分を外来担当として**均等に**補充
- 残りの看護師は「休」

## 📆 看護師ごとの休暇日数制約

- 各看護師は、**最低13日の休暇**を取得するように調整してください。
- 看護師間で大きな差が出ないよう、**休暇日数の誤差は+1以内**におさめてください。

### ✅ 休暇のカウントルール

| 勤務記号 | カウントされる休暇日数 |
|----------|------------------------|
| `休`     | 1日（+1.0）            |
| `休/`    | 半日（+0.5）           |
| `/休`    | 半日（+0.5）           |
| `1/`     | 半日（+0.5）           |
| `2/`     | 半日（+0.5）           |
| `3/`     | 半日（+0.5）           |
| `4/`     | 半日（+0.5）           |
| `/訪`    | 半日（+0.5）           |

## 📂 ファイル構成

### 1. 入力CSV: `req_shift_8.csv`
- 各看護師の休暇希望を記載
- 1行目: 日付（7/21〜8/20）、1列目: 看護師名
- セル内の記号：①〜⑥（希望種別）

### 2. テンプレートExcel: `shift_template.xlsx`
- 使用シート: `シフト表`
- 日付: C4〜AG4
- 曜日: C5〜AG5
- 看護師名: A6〜A19
- シフト記入欄: C6〜AG19（31列 × 14行）

### 3. 出力Excel: `shift_output.xlsx`
- `shift_template.xlsx` に上書きする形で出力
- 記入内容は記号で記載（夜、早、休、×、1〜4、〇など）

## 🙋‍♀️ 希望休(入力csv)のデータ例

| 看護師 | 7/22 | 7/25 | 7/30 | ... |
|--------|------|------|------|-----|
| 久保   | ①   |      | ③   |     |
| 三好   |      | ①   |      |     |

※希望内容：
- ①: 1日休み希望
- ②: 1日休み（夜勤明け可）
- ③: 午前休み
- ④: 午後休み
- ⑤: 午後休み（夜勤明け可）
- ⑥: 特記事項あり（備考欄記載）

## 📤 出力形式（CSV相当）

| 氏名 | 7/21 | 7/22 | 7/23 | ... | 8/20 |
|------|------|------|------|-----|------|
| 久保 | 早   | 休   | 1    | ... | 残   |
| 三好 | 夜   | ×    | 〇   | ... | 2    |
| ...  | ...  | ...  | ...  | ... | ...  |

※出力はシート「シフト表」のセル範囲「C6〜AG19」に記入してください。

※各看護師の名前（A6〜A19）と日付（C4〜AG4）に対応する位置に、勤務記号を記入してください。

※勤務内容は以下のいずれか：
- 夜: 夜勤
- 残: 残番
- 早: 早番
- 残日: 休日の残番
- 早日: 休日の早番
- 休: 1日休み
- /休: 午前休み（半休）
- 休/: 午後休み（半休）
- １〜４: 担当する外来の番号
- ⚪︎: 病棟担当
- ×: 夜勤の次の日（勤務不可）

## ✍️ 備考
- 出力は**xlsx形式**でお願いします。
- 上記制約と希望を**全て必ず満たす**ようなシフトを組んでください。最適化のプログラムを組むのではなく、あなたが自分で制約通りに調整して作ってください。あなたは看護師長です。看護師からクレームを受けないようにがんばってください。
- 各勤務内容を日ごとにマトリクス形式で記入してください。